# openssl heartbleed example

This repo replicates finding [heartbleed] with
[fuzzing](https://blog.hboeck.de/archives/868-How-Heartbleed-couldve-been-found.html).

## To build

Assuming you just want to build the docker image, run:

```bash
docker build -t mayhemit/openssl-cve-2014-0160 .
```

## Get from Dockerhub

If you don't want to build locally, you can pull a pre-built image
directly from dockerhub:

```bash
docker pull mayhemit/openssl-cve-2014-0160
```


## Run under Mayhem

Change to the `heartbleed` folder and run:

```bash
mayhem run .
```

and watch Mayhem replicate heartbleed! It should take very little time
(< 1 minute).

## Run locally

If you want to just run the libfuzzer target locally and you've pulled
the dockerhub image, run:

```
docker run mayhemit/openssl-cve-2014-0160
```

## POC

We have included a proof of concept output under the `poc`
directory.

Note: Fuzzing has some degree of non-determinism, so when you run
yourself you may not get exactly this file.  This is expected; your
output should still trigger the heartbleed bug.


## Layout

```
├── Dockerfile      # docker build file
├── README.md       # this file :)
├── corpus          # input corpus for fuzzing
│   └── 0decdc5225deba5e56670a94d8cad34681be7321c0caf004d87eaaae9214aa95
├── mayhem          # mayhem configuration files per target
│   └── heartbleed  # heartbleed target to check
│       ├── Mayhemfile
│       └── corpus -> ../../corpus
├── poc             # proof of concept that triggers heartbleed
│   └── crash-0c2f3ddfaf635d4393934d139031cca17ebbfaef
└── src             # additional sources needed to build docker image
    └── build.sh
```
