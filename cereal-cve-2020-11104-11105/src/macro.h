#pragma once

#define archiveWithNVP() \
    /* Choose whether to serialize as a name-value pair, or plain */ \
    if ( ds && ds->Get<bool>() ) { \
        const auto name = ds->Get<std::string>(); \
        archive(cereal::make_nvp(name, v)); \
    } else { \
        archive(v); \
    }
